<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>

<div th:fragment="frag" th:if="${child}" th:with="floor=${floor}+'1'">
	<span class="bgbox" th:classappend="'div' + ${idx}"> 
		<b class="catName" th:text="${child.name}"></b> <b th:if="${child.time} != 0" th:text="'  /  ' + ${child.time} + '  /  ' +${child.percent} " ></b>

		<b><a th:href="'/event/addByCat?targetDate=' + ${date} + '&targetCat=' + ${child.name} + '&topic=' + ${child.topic} + '&relatedId=' + ${child.relatedId}" 
			style="float:right;padding-top:0px;margin-left: 8px;margin-right: 8px;text-align: top;">+</a></b>

		<b th:if="${floor} == '1'" ><a th:href="'/event/addTopicByCat?topicDate=' + ${date} + '&topicCat=' + ${child.name}" 
				style="float:right;padding-top:0px;margin-left: 8px;text-align: top;">T</a></b>
		<!-- b th:text="${floor}"></b> -->
		<!--
		<input type="button" value="+" th:data-cat="${child.name}" th:data-topic="${child.topic}" th:data-relatedId="${child.relatedId}"
		th:onclick="addEventByCat(this.getAttribute('data-cat'), this.getAttribute('data-topic'), this.getAttribute('data-relatedId'));"
		style="float:right;font-size:small;height:20px;padding-top:0px;margin-left: 10px;text-align: top;"></input>

		<input type="button" value="T" th:if="${floor} == '1'" th:data-cat="${child.name}" 
		th:onclick="addTopicByCat(this.getAttribute('data-cat'));"
		style="float:right;font-size:small;height:20px;padding-top:0px;margin-left: 10px;text-align: top;"></input>
		-->

		<!--
		<input type="button" value="A" th:if="${floor} == '1'" th:data-cat="${child.name}" 
		th:onclick="addTopicByCat(this.getAttribute('data-cat'));"
		style="float:right;font-size:small;height:20px;padding-top:0px;margin-left: 10px;text-align: top;"></input>		
		-->
	<div th:unless="${#lists.isEmpty(child.items)}">
		<table class="table table-bordered noborder headline">
			<tr th:each="item, itemStat : ${child.items}">
				<td hidden="">
					<input th:name="|items[${item.getIndex()}].id|" th:value="${item.getId()}" readonly="true"/>
				</td>
				<td width="40%">
					<input th:name="|items[${item.getIndex()}].name|" th:value="${item.getName()}" />
				</td>
				<td hidden="">
					<input th:name="|items[${item.getIndex()}].category|" th:value="${item.getCategory()}" class="category"/>
				</td>
				<td hidden="">
					<input th:name="|items[${item.getIndex()}].status|" th:value="${item.getStatus()}" class="status"  />
				</td>
				<td width="20%">
					<input th:name="|items[${item.getIndex()}].time|" th:value="${item.getTime()}" class="time" />
				</td>
				<td>
					<input th:name="|items[${item.getIndex()}].memo|" th:value="${item.getMemo()}" />
				</td>			
				<td hidden="">
					<input th:name="|items[${item.getIndex()}].date|" th:value="${date}" readonly="true" />
				</td>
				<td>
					<a th:href="'/event/editSingleEvent?id=' + ${item.getId()} + '&date=' +${item.getDate()}" th:text="E" ></a>
				</td>				
			</tr>
		</table>
	</div>
	</span>
	<ul class="wtree">
		<li th:each="child, childStat : ${child.children}">
			<div th:replace="event_rec :: frag">(sub-nodes here)</div>
		</li>
	</ul>

</div>
	
</body>