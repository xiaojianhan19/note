<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
<meta charset="UTF-8"></meta>
<link rel="stylesheet" th:href="@{/style.css}"></link>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"
        th:src="@{/webjars/jquery/1.12.4/jquery.min.js}"></script>
<script th:inline="javascript">
/*<![CDATA[*/
function deleteItem(id) {
    document.getElementById("delId").value = id;
	deleteForm.submit();
}
/*]]>*/
</script>
</head>
<body>
<div layout:fragment="content">

  <form name="deleteForm" method="POST" action="#" th:action="@{/item/delete}" >
    <input type="hidden" id="delId" name="delId" value=""></input>
  </form>

  <form name="addForm" method="POST" action="#" th:action="@{/item/save}" th:object="${itemBean}">
    <table class="table table-bordered noborder fcol">
      <tr>
          <td >id</td><td ><input th:field="*{id}" /></td>
          <td >parentId</td><td ><input th:field="*{parentId}" /></td>
        </tr>      
        <tr>
          <td >name</td><td ><input th:field="*{name}" /></td>
          <td >name2</td><td ><input th:field="*{name2}" /></td>
        </tr>      
        <tr>
          <td >name3</td><td ><input th:field="*{name3}" /></td>
          <td >status</td><td ><input th:field="*{status}"  id="inputStatus" class="status" /></td>
        </tr>      
        <tr>
          <td >categoryId</td><td ><input th:field="*{categoryId}" /></td>
          <td >category</td><td ><input th:field="*{category}"  id="inputCategory" class="category" /></td>
        </tr>      
        <tr>
          <td >level</td><td ><input th:field="*{level}"  id="inputTime" /></td>
        </tr>      
        <tr>
          <td >date</td><td ><input th:field="*{date}"  id="date" /></td>
          <td >releaseDate</td><td ><input th:field="*{releaseDate}"  id="releaseDate" /></td>
        </tr>
        <tr>
          <td>memo</td><td colspan="3"><textarea th:field="*{memo}" ></textarea></td>
        </tr>
      </table>
        <input type="submit" value="Update" />
        <input type="button" value="Delete" th:data-id="${itemBean.id}" th:onclick="deleteItem(this.getAttribute('data-id'));" ></input>
        <a style="float:right;" th:text="Edit" th:href="@{'/item/itemEdit?itemId=' + ${itemBean.id}}"></a>
        <a style="float:right;" th:text="EditGroup" th:href="@{'/item/itemEdit?itemId=' + ${itemBean.id}}"></a>
  </form>

  <div th:if="${itemBean.url != null and itemBean.url != ''}">
    <hr>
    <img class="main-img" th:src="'/' + ${itemBean.url}" />
    
    <br>
    <a th:href="'/file/download?fileName=' + ${itemBean.url}" th:text="${itemBean.url}"></a>
    
  </div>

  <div th:unless="${#lists.isEmpty(itemBean.items)}">
    <hr/>
    <h3>Items</h3>
    <table class="table table-bordered table-hover table-striped">
        <th:block th:unless="${#lists.isEmpty(itemBean.items)}" th:each="current : ${itemBean.items}">
          <tr>
            <td><a style="color:blue;" th:text="${current.name}" th:href="@{'/item/item?itemId=' + ${current.id}}"></td>
            <td><a style="color:blue;" th:text="Edit" th:href="@{'/item/itemEdit?itemId=' + ${current.id}}"></td>
          </tr>
          <tr>
            <td colspan="11">
              <div id="article" th:text="${current.memo}"></div>
            </td>
          </tr>
        </th:block>
    </table>
  </div>

  <div th:unless="${#lists.isEmpty(itemBean.resources)}">
    <hr/>
    <h3>Resources</h3>
    <table class="table table-bordered table-hover table-striped">
        <th:block th:unless="${#lists.isEmpty(itemBean.resources)}" th:each="current : ${itemBean.resources}">
          <tr>
            <td th:text="${current.index}"></td>
            <td><a style="color:blue;" th:text="${current.name}" th:href="@{'/item/resource?resourceId=' + ${current.id}}"></td>
            <td><a style="color:blue;" th:text="Edit" th:href="@{'/item/resourceEdit?resourceId=' + ${current.id}}"></td>
          </tr>
          <tr th:if="${current.url==null}">
            <td colspan="11">
              <div id="article" th:text="${current.text}"></div>
            </td>
          </tr>
          <tr th:if="${current.url!=null}">
            <td colspan="11">
              <b>File Download : </b><a th:href="'/file/download?fileName=' + ${current.url}" th:text="${current.url}"></a>
            </td>
          </tr>        
        </th:block>
    </table>
  </div>

  <div th:if="${resourceBean!=null}">
    <hr/>
    <h3>Resources</h3>
    <table class="table table-bordered table-hover table-striped">
        <tr>
            <td th:text="${resourceBean.index}"></td>
            <td><a style="color:blue;" th:text="${resourceBean.name}" th:href="@{'/item/resource?resourceId=' + ${resourceBean.id}}"></td>
            <td><a style="color:blue;" th:text="Edit" th:href="@{'/item/resourceEdit?resourceId=' + ${resourceBean.id}}"></td>
          </tr>
          <tr>
            <td colspan="11">
              <div id="article" th:text="${resourceBean.text}"></div>
            </td>
          </tr>
    </table>
  </div>

</div>
</body>
</html>